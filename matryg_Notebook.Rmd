---
title: "ICY0006 - Probability Theory and Statistics - Matryg project, TalTech"
output: html_notebook
---

# Stage 1  

## Introduction
This is my project for the course ICY0006 - Probability Theory and Statistics at TalTech University.  
Among the content of my project is a matryg_Notebook.Rmd-file and from that file a html-file can be generated and read as a report.
Any questions related to the report can be sent to my mail: matryg@ttu.ee  
The link to my GitHub repo is https://github.com/matry18/matrygV3  
Enjoy the reading!  

## The work environment  
For this project I have used RStudio as my IDE. I have used version control with Git and continuously committed my work to GitHub, where the repository is public accessible.  
I have used the Notebook function in RStudio to generate the matryg_Notebook.Rmd-file from where a html-file can be generated and read as the report for this project.  
The development of the report was an ongoing process following the progression of the course and continuous implementing the topics thought in the lecture and practices.  

## The dataset  
The original dataset for this project was based on house prices and computer generated. This caused some issues since the dataset was not suitable due to the certain problem. Because of that the dataset was changed 4 weeks into the course. Doing the 8th week of the course I faced some problems with all the possible linear regressions in the dataset being heteroscedastic. This lead to another change of the dataset. Therefore this dataset is version 3 in my project.  

This dataset is about lung capacity and is public available at https://www.kaggle.com/aakashmisra/lung-capacity with an unknown license. The version of the dataset is Version 1 and was created the 28/9 2020 by the user Aakash Misra - https://www.kaggle.com/aakashmisra  
The dataset is a .csv-file and I downloaded it and unzipped it before importing it. When doing the importing of the dataset I used a dynamic file.choose() method where I chose the downloaded and unzipped file.  
```{r}
data1 <- read.csv(file.choose(), header=TRUE)
View(data1)
attach(data1)
```

To be able to manipulate and visualize the dataset the libraries and dependencies was loaded.
```{r}
##Data Manipulation
library(tidyverse)
library(psych)
library(lubridate)
library(xts)
library(tseries)
library(forecast)
library(MLmetrics)
library(MASS)
#Visualisation 
library(corrplot)
library(plotly)
library(viridis)
library(ggmap)
library(knitr)
library(dygraphs)
library(ggthemes)
library(reshape)
library(reshape2)
library(ggplot2)
library(ggcorrplot)
library(ggstatsplot)
```

## Variables  
In the following I will describe the variables in the dataset.  
The dataset consists of 725 observations and has 6 variables.  

**LungCap** is short for lung capacity also know as total lung capacity (TLC). Lung capacity is the volume of air in the lungs upon the maximum effort of inspiration.  Among healthy adults, the average lung capacity is about 6 liters. Age, gender, body composition, and ethnicity are factors affecting the different ranges of lung capacity among individuals. TLC rapid increases from birth to adolescence and plateaus at around 25 years old. Males tend to have a greater TLC than females, while individuals with tall stature tend to have greater TLC than those with short stature, and individuals with a high waist-to-hip ratio generally have a lower TLC. Individuals of African descent have a lower TLC compared to individuals of European descent. Additional factors that affect an individual's lung capacity include the level of physical activity, chest wall deformities, and respiratory diseases.^[From https://www.ncbi.nlm.nih.gov/books/NBK541029/, seen 17/12-20.]  
The lung capacity is a dependent variable since it is influenced by age, gender etc. It is a continuous value as well as quantitative. It is measured on an interval scale.  

**Age** indicates the persons age in years. This variable is independent, quantitative and discrete since all the age values are presented as integer values on an interval scale.  

**Height** is the height in inches. This is an independent, continuous, quantitative variable measured on an interval scale. This variable must be transformed into a measurement of  meter. Therefore I multiply the height value with 0.0254 to get the value in meter. This value has been added to the dataset as the variable **HeightMeter** and share the same characteristics as Height.
```{r}
data1$HeightMeter <- data1[,3]*0.0254
View(data1)
```
The **Smoke** variable is independent, discrete and qualitative. It defines if the person is smoking, since it influences the lung capacity. The categorical values is "yes" if the person smokes and "no" if the person does not smoke. This is measured on a nominal scale. As an alternative the true/false-value could have been indicated with numbers, where 1 is true and 0 is false, but for now I will not manipulate the value.  

**Gender** defines the gender of the person. This variable is independent, discrete and qualitative measured on a nominal scale. If the person is male the value is "male" and if the person is female the value is "female". As an alternative the true/false-value could have been indicated with numbers, where 1 is true and 0 is false, but for now I will not manipulate the value.  


The **Caesarean** indicates how the person was born. If the person was born by caesarean the value is "yes" and if not the value is "no". This is an independent, discrete, qualitative variable measured on a nominal scale. As an alternative the true/false-value could have been indicated with numbers, where 1 is true and 0 is false, but for now I will not manipulate the value.  

### Missing data
Before going any further with the dataset I will check for any missing values by the use of the inbuilt function in R Studio.
```{r}
which(is.na(data1))
```
Since the returned value is zero that means that I don't have any missing data in my dataset.  

### Data visualization  
In the following I will visualize each variable. For Lung capacity, age and height in meters I have used histograms. Since histograms are strongly affected by the number of bins and therefore makes it difficult to determine the shape of the distribution I have added a normal curve to the histograms.  
Another way of viewing the variables could be with the use of Kernel Density plots. Therefore I have chosen to visualize the lung capacity, age and height in meters with this curve.  
**Lung capacity**
```{r}
hist(data1$LungCap, las=1, ylim= c(0,120),xlab = "Lung capacity", main= "Histogram of lung capacity")

x <- data1$LungCap
h<-hist(x, breaks=20, col="red", xlab="Lung capacity", las=1, main="Histogram with Normal Curve", ylim = c(0,120), xlim = c(0,15))
xfit<-seq(min(x),max(x),length=40)
yfit<-dnorm(xfit,mean=mean(x),sd=sd(x))
yfit <- yfit*diff(h$mids[1:2])*length(x)
lines(xfit, yfit, col="blue", lwd=2)

plot(density(data1$LungCap), main = "Kernel Density of lung capacity", xlab = "Lung capacity", las=1)
```
**Age**
```{r}
hist(data1$Age, xlim = c(0,20), ylim=c(0,80), las=1, xlab = "Age in years", main= "Histogram of age", breaks = 20)

x <- data1$Age
h<-hist(x, breaks=20, col="red", xlab="Age in years", las=1, main="Histogram with Normal Curve", ylim = c(0,80), xlim = c(0,20))
xfit<-seq(min(x),max(x),length=40)
yfit<-dnorm(xfit,mean=mean(x),sd=sd(x))
yfit <- yfit*diff(h$mids[1:2])*length(x)
lines(xfit, yfit, col="blue", lwd=2)

plot(density(data1$Age), main = "Kernel Density of age", xlab = "Age in years", las=1)
```

**Height in meters**
```{r}
hist(data1$HeightMeter, xlim= c(1,2.2), ylim = c(0,100), las=1, xlab = "Height in meter", main= "Histogram of height in meter", breaks = 20)

x <- data1$HeightMeter
h<-hist(x, breaks=20, col="red", xlab="Height in meter", las=1, main="Histogram with Normal Curve", ylim = c(0,100), xlim = c(1,2.2))
xfit<-seq(min(x),max(x),length=40)
yfit<-dnorm(xfit,mean=mean(x),sd=sd(x))
yfit <- yfit*diff(h$mids[1:2])*length(x)
lines(xfit, yfit, col="blue", lwd=2)

plot(density(data1$HeightMeter), main = "Kernel Density of height in meter", xlab = "Height in meter", las=1)
```
For the categorical variables I first had to convert them into numerical values before they could be visualized. For Smoke and Caesarean the original value was "no" or "yes" which I turned into a numerical representation where "yes" = 1 and "no" = 0. For the gender variable the value "male" was set to 1 and the value "female" was set to 0.
```{r}
data1Num <- data1 %>% mutate(Smoke = case_when(Smoke == "yes" ~ 1, Smoke == "no" ~ 0), Gender = case_when(Gender == "male" ~ 1, Gender == "female" ~ 0), Caesarean = case_when(Caesarean == "yes" ~ 1, Caesarean == "no" ~ 0))
```
After having converted the categorical values they are visualized in a pie chart.
**Smoke**
```{r}
mytable <- table(data1Num$Smoke)
lbls <- paste(names(mytable), "\n", mytable, sep="")
pie(mytable, labels = lbls,
   main="Distribution of people who smoke,\n (with sample sizes)", xlab="0 = do not smoke, 1 = do smoke")
```
**Gender**
```{r}
mytable <- table(data1Num$Gender)
lbls <- paste(names(mytable), "\n", mytable, sep="")
pie(mytable, labels = lbls,
   main="Distribution of gender,\n (with sample sizes)", xlab="0 = female, 1 = male")
```
**Caesarean**
```{r}
mytable <- table(data1Num$Caesarean)
lbls <- paste(names(mytable), "\n", mytable, sep="")
pie(mytable, labels = lbls,
   main="Distribution of people born by caesarean,\n (with sample sizes)", xlab="0 = not born by caesarean, 1 = born by caesarean")
```
### Interpreting the visualization  
In the following I will describe what can be seen from the graphs and charts.  

The lung capacity has a nice bell shape, which indicates a normal distribution. The distribution is very close to be complete symmetrical with a single peek.  
The age variable is close of having a nice bell shape but it tends to have a small negative skewness. It has a single peek and is close to being symmetrical but not complete symmetrical.  
The height in meter has a very nice bell shape which indicates a normal distribution with a single peek and the shape of it is very close to be symmetrical.  
The distribution of people who smoke indicates that approx. 1/8 of the people in the population do smoke and 7/8 does not.  
The distribution of genders is close to be even with slightly more males than females in the population.  
The distribution of people born by ceasarean shows that nearly 1/4 of the population is born by caesarean and 3/4 is not.  








